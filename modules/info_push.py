import rtoml
from pathlib import Path
import requests

# 读取配置项信息
CONFIG = rtoml.load(Path(__file__).parent / "../config.toml")
WEBHOOK = CONFIG["webhook"]


def post_message_to_WXWork(msg: str) -> None:
    # sourcery skip: remove-redundant-pass
    """推送 markdown 信息到企微Bot"""
    print("推送信息到企微Bot")
    print(f'当前msg字节数为 {len(msg.encode("utf-8"))}')
    requests.post(
        url=WEBHOOK,
        headers={
            "Content-Type": "application/json",
        },
        json={
            "msgtype": "markdown",
            "markdown": {"content": f"{msg}"},
        },
    )
    print("推送信息到企微Bot完成")
